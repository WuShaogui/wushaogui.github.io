<!DOCTYPE html><html lang="zh-CN"><head><meta charset="UTF-8"><meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=2"><meta name="theme-color" content="#222"><meta name="generator" content="Hexo 5.3.0"><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png"><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png"><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png"><link rel="mask-icon" href="/images/logo.svg" color="#222"><link rel="stylesheet" href="/css/main.css"><link rel="stylesheet" href="//fonts.googleapis.com/css?family=Noto Serif SC:300,300italic,400,400italic,700,700italic|Roboto Mono:300,300italic,400,400italic,700,700italic|PT Mono:300,300italic,400,400italic,700,700italic&display=swap&subset=latin,latin-ext"><link rel="stylesheet" href="/lib/font-awesome/css/all.min.css"><link rel="stylesheet" href="/lib/pace/pace-theme-minimal.min.css"><script src="/lib/pace/pace.min.js"></script><script id="hexo-configurations">var NexT=window.NexT||{},CONFIG={hostname:"shaogui.life",root:"/",scheme:"Gemini",version:"7.8.0",exturl:!1,sidebar:{position:"left",display:"post",padding:18,offset:12,onmobile:!1,width:240},copycode:{enable:!0,show_result:!0,style:"flat"},back2top:{enable:!0,sidebar:!0,scrollpercent:!0},bookmark:{enable:!1,color:"#222",save:"auto"},fancybox:!1,mediumzoom:!1,lazyload:!1,pangu:!1,comments:{style:"tabs",active:null,storage:!0,lazyload:!1,nav:null},algolia:{hits:{per_page:10},labels:{input_placeholder:"Search for Posts",hits_empty:"We didn't find any results for the search: ${query}",hits_stats:"${hits} results found in ${time} ms"}},localsearch:{enable:!0,trigger:"auto",top_n_per_article:1,unescape:!1,preload:!1},motion:{enable:!0,async:!1,transition:{post_block:"fadeIn",post_header:"slideDownIn",post_body:"slideDownIn",coll_header:"slideLeftIn",sidebar:"slideUpIn"}},path:"search.xml"}</script><meta name="description" content="书名: Keras快速上手：基于Python的深度学习实战 			作者: 谢梁 			出版年份: 2017-8 			评分: 4.7 		 	   	.douban-card-block { 		display: flex; 		justify-content: center; 		align-items: cente"><meta property="og:type" content="article"><meta property="og:title" content="书摘：《Keras快速上手：基于Python的深度学习实战》-谢梁;鲁颖;劳虹岚"><meta property="og:url" content="https://shaogui.life/2020/06/02/%E4%B9%A6%E6%91%98_Keras%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%EF%BC%9A%E5%9F%BA%E4%BA%8EPython%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%AE%9E%E6%88%98-%E8%B0%A2%E6%A2%81;%E9%B2%81%E9%A2%96;%E5%8A%B3%E8%99%B9%E5%B2%9A.hexo/index.html"><meta property="og:site_name" content="年轻人起来冲"><meta property="og:description" content="书名: Keras快速上手：基于Python的深度学习实战 			作者: 谢梁 			出版年份: 2017-8 			评分: 4.7 		 	   	.douban-card-block { 		display: flex; 		justify-content: center; 		align-items: cente"><meta property="og:locale" content="zh_CN"><meta property="article:published_time" content="2020-06-02T02:50:55.000Z"><meta property="article:modified_time" content="2022-06-15T01:53:18.325Z"><meta property="article:author" content="绍桂"><meta property="article:tag" content="读书"><meta name="twitter:card" content="summary"><link rel="canonical" href="https://shaogui.life/2020/06/02/%E4%B9%A6%E6%91%98_Keras%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%EF%BC%9A%E5%9F%BA%E4%BA%8EPython%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%AE%9E%E6%88%98-%E8%B0%A2%E6%A2%81;%E9%B2%81%E9%A2%96;%E5%8A%B3%E8%99%B9%E5%B2%9A.hexo/"><script id="page-configurations">CONFIG.page={sidebar:"",isHome:!1,isPost:!0,lang:"zh-CN"}</script><title>书摘：《Keras快速上手：基于Python的深度学习实战》-谢梁;鲁颖;劳虹岚 | 年轻人起来冲</title><noscript><style>.sidebar-inner,.use-motion .brand,.use-motion .collection-header,.use-motion .comments,.use-motion .menu-item,.use-motion .pagination,.use-motion .post-block,.use-motion .post-body,.use-motion .post-header{opacity:initial}.use-motion .site-subtitle,.use-motion .site-title{opacity:initial;top:initial}.use-motion .logo-line-before i{left:initial}.use-motion .logo-line-after i{right:initial}</style></noscript><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.12.0/dist/katex.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/hexo-math@4.0.0/dist/style.css"><link rel="alternate" href="/atom.xml" title="年轻人起来冲" type="application/atom+xml"></head><body itemscope itemtype="http://schema.org/WebPage"><div class="container use-motion"><div class="headband"></div><header class="header" itemscope itemtype="http://schema.org/WPHeader"><div class="header-inner"><div class="site-brand-container"><div class="site-nav-toggle"><div class="toggle" aria-label="切换导航栏"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div></div><div class="site-meta"><a href="/" class="brand" rel="start"><span class="logo-line-before"><i></i></span><h1 class="site-title">年轻人起来冲</h1><span class="logo-line-after"><i></i></span></a></div><div class="site-nav-right"><div class="toggle popup-trigger"><i class="fa fa-search fa-fw fa-lg"></i></div></div></div><nav class="site-nav"><ul id="menu" class="main-menu menu"><li class="menu-item menu-item-home"><a href="/" rel="section"><i class="fa fa-home fa-fw"></i>首页</a></li><li class="menu-item menu-item-archives"><a href="/archives/" rel="section"><i class="fa fa-archive fa-fw"></i>归档</a></li><li class="menu-item menu-item-categories"><a href="/categories/" rel="section"><i class="fa fa-th fa-fw"></i>分类</a></li><li class="menu-item menu-item-tags"><a href="/tags/" rel="section"><i class="fa fa-tags fa-fw"></i>标签</a></li><li class="menu-item menu-item-about"><a href="/about/" rel="section"><i class="fa fa-user fa-fw"></i>关于</a></li><li class="menu-item menu-item-search"><a role="button" class="popup-trigger"><i class="fa fa-search fa-fw"></i>搜索</a></li></ul></nav><div class="search-pop-overlay"><div class="popup search-popup"><div class="search-header"><span class="search-icon"><i class="fa fa-search"></i></span><div class="search-input-container"><input autocomplete="off" autocapitalize="off" placeholder="搜索..." spellcheck="false" type="search" class="search-input"></div><span class="popup-btn-close"><i class="fa fa-times-circle"></i></span></div><div id="search-result"><div id="no-result"><i class="fa fa-spinner fa-pulse fa-5x fa-fw"></i></div></div></div></div></div></header><a href="https://github.com/WuShaogui" class="github-corner" title="Follow me on GitHub" aria-label="Follow me on GitHub" rel="noopener" target="_blank"><svg width="80" height="80" viewBox="0 0 250 250" aria-hidden="true"><path d="M0,0 L115,115 L130,115 L142,142 L250,250 L250,0 Z"></path><path d="M128.3,109.0 C113.8,99.7 119.0,89.6 119.0,89.6 C122.0,82.7 120.5,78.6 120.5,78.6 C119.2,72.0 123.4,76.3 123.4,76.3 C127.3,80.9 125.5,87.3 125.5,87.3 C122.9,97.6 130.6,101.9 134.4,103.2" fill="currentColor" style="transform-origin:130px 106px" class="octo-arm"></path><path d="M115.0,115.0 C114.9,115.1 118.7,116.5 119.8,115.4 L133.7,101.6 C136.9,99.2 139.9,98.4 142.2,98.6 C133.8,88.0 127.5,74.4 143.8,58.0 C148.5,53.4 154.0,51.2 159.7,51.0 C160.3,49.4 163.2,43.6 171.4,40.1 C171.4,40.1 176.1,42.5 178.8,56.2 C183.1,58.6 187.2,61.8 190.9,65.4 C194.5,69.0 197.7,73.2 200.1,77.6 C213.8,80.2 216.3,84.9 216.3,84.9 C212.7,93.1 206.9,96.0 205.4,96.6 C205.1,102.4 203.0,107.8 198.3,112.5 C181.9,128.9 168.3,122.5 157.7,114.1 C157.9,116.9 156.7,120.9 152.7,124.9 L141.0,136.5 C139.8,137.7 141.6,141.9 141.8,141.8 Z" fill="currentColor" class="octo-body"></path></svg></a><main class="main"><div class="main-inner"><div class="content-wrap"><div class="content post posts-expand"><article itemscope itemtype="http://schema.org/Article" class="post-block" lang="zh-CN"><link itemprop="mainEntityOfPage" href="https://shaogui.life/2020/06/02/%E4%B9%A6%E6%91%98_Keras%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%EF%BC%9A%E5%9F%BA%E4%BA%8EPython%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%AE%9E%E6%88%98-%E8%B0%A2%E6%A2%81;%E9%B2%81%E9%A2%96;%E5%8A%B3%E8%99%B9%E5%B2%9A.hexo/"><span hidden itemprop="author" itemscope itemtype="http://schema.org/Person"><meta itemprop="image" content="/images/avatar.gif"><meta itemprop="name" content="绍桂"><meta itemprop="description" content="害怕失败是本能，勇敢面对才是本事"></span><span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization"><meta itemprop="name" content="年轻人起来冲"></span><header class="post-header"><h1 class="post-title" itemprop="name headline">书摘：《Keras快速上手：基于Python的深度学习实战》-谢梁;鲁颖;劳虹岚</h1><div class="post-meta"><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar"></i> </span><span class="post-meta-item-text">发表于</span> <time title="创建时间：2020-06-02 10:50:55" itemprop="dateCreated datePublished" datetime="2020-06-02T10:50:55+08:00">2020-06-02</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-calendar-check"></i> </span><span class="post-meta-item-text">更新于</span> <time title="修改时间：2022-06-15 09:53:18" itemprop="dateModified" datetime="2022-06-15T09:53:18+08:00">2022-06-15</time> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-folder"></i> </span><span class="post-meta-item-text">分类于</span> <span itemprop="about" itemscope itemtype="http://schema.org/Thing"><a href="/categories/%E8%AF%BB%E4%B9%A6/" itemprop="url" rel="index"><span itemprop="name">读书</span></a> </span></span><span id="/2020/06/02/%E4%B9%A6%E6%91%98_Keras%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%EF%BC%9A%E5%9F%BA%E4%BA%8EPython%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%AE%9E%E6%88%98-%E8%B0%A2%E6%A2%81;%E9%B2%81%E9%A2%96;%E5%8A%B3%E8%99%B9%E5%B2%9A.hexo/" class="post-meta-item leancloud_visitors" data-flag-title="书摘：《Keras快速上手：基于Python的深度学习实战》-谢梁;鲁颖;劳虹岚" title="阅读次数"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span class="leancloud-visitors-count"></span> </span><span class="post-meta-item" title="阅读次数" id="busuanzi_container_page_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="post-meta-item-text">阅读次数：</span> <span id="busuanzi_value_page_pv"></span> </span><span class="post-meta-item"><span class="post-meta-item-icon"><i class="far fa-comment"></i> </span><span class="post-meta-item-text">Valine：</span> <a title="valine" href="/2020/06/02/%E4%B9%A6%E6%91%98_Keras%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%EF%BC%9A%E5%9F%BA%E4%BA%8EPython%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%AE%9E%E6%88%98-%E8%B0%A2%E6%A2%81;%E9%B2%81%E9%A2%96;%E5%8A%B3%E8%99%B9%E5%B2%9A.hexo/#valine-comments" itemprop="discussionUrl"><span class="post-comments-count valine-comment-count" data-xid="/2020/06/02/%E4%B9%A6%E6%91%98_Keras%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%EF%BC%9A%E5%9F%BA%E4%BA%8EPython%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%AE%9E%E6%88%98-%E8%B0%A2%E6%A2%81;%E9%B2%81%E9%A2%96;%E5%8A%B3%E8%99%B9%E5%B2%9A.hexo/" itemprop="commentCount"></span></a></span><br><span class="post-meta-item" title="本文字数"><span class="post-meta-item-icon"><i class="far fa-file-word"></i> </span><span class="post-meta-item-text">本文字数：</span> <span>14k</span> </span><span class="post-meta-item" title="阅读时长"><span class="post-meta-item-icon"><i class="far fa-clock"></i> </span><span class="post-meta-item-text">阅读时长 &asymp;</span> <span>13 分钟</span></span></div></header><div class="post-body" itemprop="articleBody"><div class="douban-card-block"><a class="douban-card" target="_blank" rel="noopener" href="https://book.douban.com/subject/27093647"><div class="douban-card-bgimg" style="background-image:url(https://images.weserv.nl/?url=https://img1.doubanio.com/view/subject/s/public/s29499730.jpg)"></div><div class="douban-card-left"><div class="douban-card-img" style="background-image:url(https://images.weserv.nl/?url=https://img1.doubanio.com/view/subject/s/public/s29499730.jpg)"></div></div><div class="douban-card-right" style="line-height:1.7"><div class="douban-card-item"><span>书名: </span><strong>Keras快速上手：基于Python的深度学习实战</strong></div><div class="douban-card-item"><span>作者: </span><span>谢梁</span></div><div class="douban-card-item"><span>出版年份: </span><span>2017-8</span></div><div class="douban-card-item"><span>评分: </span><span>4.7</span></div></div></a></div><style>.douban-card-block{display:flex;justify-content:center;align-items:center;width:100%;max-height:400px}.douban-card{display:flex;margin:30px 10px;padding:15px;border-radius:10px;position:relative;justify-content:center;align-items:center;overflow:hidden;color:#faebd7;text-decoration:none}.douban-card:hover{text-decoration:none}.douban-card-bgimg{position:absolute;width:115%;height:115%;filter:blur(15px) brightness(.6);background-size:100%;background-position:center;background-repeat:no-repeat}.douban-card-img{position:relative;height:130px;width:80px;background-size:100%;background-position:center;background-repeat:no-repeat}.douban-card-img{position:relative;height:130px;width:80px}.douban-card-left{position:relative;display:flex;flex-direction:column;align-items:center}.douban-card-right{position:relative;display:flex;flex-direction:column;margin-left:12px;font-size:16px;font-family:'Courier New',Courier,monospace;line-height:1.3;color:#faebd7}.douban-card-item{margin-top:4px}</style><a id="more"></a><h2 id="1准备深度学习的环境"><a class="markdownIt-Anchor" href="#1准备深度学习的环境"></a> 1准备深度学习的环境</h2><blockquote><p>cuDNN是NVIDIA开发的专门强化卷积神经网络模型训练的库，全称为NVIDIACUDADeepNeuralNetworklibrary，支持常见的深度学习软件，比如CNTK、Caffe、Theano、Keras、TensorFlow等。cuDNN对卷积神经网络模型的训练速度能提升2~3倍，</p></blockquote><blockquote><p>CNMeM是NVIDIA开发的一个显存管理分配软件。预先给深度学习项目分配足够的显存能有效提高训练速度，一般提升10%左右。</p></blockquote><h2 id="2数据收集与处理"><a class="markdownIt-Anchor" href="#2数据收集与处理"></a> 2数据收集与处理</h2><blockquote><p>TF-IDF（TermFrequency–InverseDocumentFrequency）是一种用于进行信息检索与数据挖掘的常用加权技术，用以评估一个词对于一个段落集或一个语料库中的其中一个段落的重要程度。</p></blockquote><blockquote><p>Word2Vec是Google推出的用来进行词的向量表达的开源工具包，这个名字也是该工具包所代表的算法的称号。</p></blockquote><blockquote><p>Word2Vec的主要思想是把词表达为低维度向量的形式，含义相近的词在这个低维度向量空间中的位置相近，而不相关的词则距离较远。</p></blockquote><h2 id="3深度学习简介"><a class="markdownIt-Anchor" href="#3深度学习简介"></a> 3深度学习简介</h2><blockquote><p>大多数神经网络中都包含四类函数：组合函数（CombinationFunction）、激活函数（ActivationFunction）、误差函数（ErrorFunction）和目标函数（ObjectFunction）。</p></blockquote><blockquote><p>在网络中间将向量映射为标量的函数就被称为组合函数。常见的组合函数包括线性组合函数和基于欧式空间距离的函数，比如在RBF网络中常用的函数。</p></blockquote><blockquote><p>激活函数通常都是将一个实数域上的值映射到一个有限域中，因此也被称为塌缩函数。比如常见的tanh或者logistic函数，都是将无限的实数域上的数值压缩到（-1，1）或者（0，1）之间的有限域中。如果这个激活函数不做任何变换，则被称为Identity或者线性激活函数。激活函数的主要作用是为隐含层引入非线性。一个只有线性关系隐含层的多层神经网络不会比一般的只包含输入层和输出层的两层神经网络更加强大，因为线性函数的函数仍然是一个线性函数。但是加入非线性以后，多层神经网络的预测能力就得到了显著提高。</p></blockquote><blockquote><p>对于后向传播算法，激活函数必须可微，而且如果这个函数是在有限域中的话，则效果更好，因此像logistic、tanh、高斯函数等都是比较常见的选择，这类函数也被统称为sigmoid函数。</p></blockquote><blockquote><p>早期的理论认为sigmoid激活函数通常比threshold激活函数（比如ReLU等激活函数）好。</p></blockquote><blockquote><p>梯度消亡指的是梯度（误差的信号）随着隐藏层数的增加成指数减小。这是因为在后向传播算法中，对梯度的计算使用链式法则，因此在第n层时需要将前面各层的梯度都相乘，但是由于sigmoid函数的值域在（-1，1）或者（0，1）之间，因此多个很小的数相乘以后第n层的梯度就会接近于0，造成模型训练的困难。</p></blockquote><blockquote><p>对于输出层，读者应该尽量选择适合因变量分布的激活函数。对于只有0，1取值的双值因变量，logistic函数是一个较好的选择。对于有多个取值的离散因变量，比如0到9数字的识别，softmax激活函数是logistic激活函数的自然衍生。对于有有限值域的连续因变量，logistic或者tanh激活函数都可以用，但是需要将因变量的值域伸缩到logistic或者tanh对应的值域中。如果因变量取值为正，但是没有上限，那么指数函数是一个较好的选择。如果因变量没有有限值域，或者虽然是有限值域但是边界未知，那么最好采用线性函数作为激活函数。</p></blockquote><blockquote><p>模型输出值p和真实值y之间的差异一般被称为残差或者误差，但是这个值并不能直接用来衡量模型的质量。当一个模型完美的时候（虽然这不可能出现），其误差为0，而当一个模型不够完美的时候，其误差不论为负值还是正值，都偏离0；因此衡量模型质量的是误差偏离0的相对值，即误差函数的值越接近于0，模型的性能越好，反之则模型的性能越差。误差函数也被称为损失函数。常用的误差函数如下。</p></blockquote><blockquote><p>交叉熵可以被解释为映射到最可能的类别的概率的对数。因此，当预测值的分布和实际因变量的分布尽可能一致时，交叉熵最小。</p></blockquote><blockquote><p>目标函数是需要在训练阶段直接最小化的那个函数。</p></blockquote><blockquote><p>批量，即Batch，是深度学习中的一个重要概念。批量通常指两个不同的概念——如果对应的是模型训练方法，那么批量指的是将所有数据处理完以后一次性更新权重或者参数的估计；如果对应的是模型训练中的数据，那么批量通常指的是一次输入供模型计算用的数据量。这两个概念有着紧密的关系。</p></blockquote><blockquote><p>在离线学习中，所有的数据都可以被反复获取，比如上面的批量学习就是离线学习的一种。而在在线学习中，每个观测值在处理以后会被遗弃，同时参数得到更新。</p></blockquote><blockquote><p>离线学习有如下几个优点。对于任何固定个数的参数，目标函数都可以直接被计算出来，因此很容易验证模型训练是否在朝着所需要的方向发展。计算精度可以达到任意合理的程度。可以使用各种不同的算法来避免出现局部最优的情况。可以采用训练、验证、测试三分法对模型的普适度进行验证。可以计算预测值及其置信区间。</p></blockquote><blockquote><p>在深度学习中，采用sigmoid激活函数的隐藏层或者输出层的神经元通常在计算网络输入时加入一个偏移值，称为Bias。对于线性输出神经元，偏移项就是回归中的截距项。</p></blockquote><blockquote><p>三个常见的“标准化”数据处理动作。（1）重放缩（Rescaling）：通常指将一个向量加上或者减去一个常量，再乘以或者除以一个常量。比如将华氏温度转换为摄氏温度就是一个重放缩的过程。（2）规范化（Normalization）：通常指将一个向量除以其范数，比如采用欧式空间距离，则用向量的方差作为范数来规范化向量。在深度学习中，规范化通常采用极差为范数，即将向量减去最小值，并除以其极差，从而使数值范围在0到1之间。（3）标准化（Standardization）：通常指将一个向量移除其位置和规模的度量。比如一个服从正态分布的向量，可以减去其均值，并除以其方差来标准化数据，从而获得一个服从标准正态分布的向量。</p></blockquote><h2 id="4keras入门"><a class="markdownIt-Anchor" href="#4keras入门"></a> 4Keras入门</h2><blockquote><p>Keras针对几种常见的输入深度学习模型和输入数据形态，提供了几个易于使用的工具来处理数据，包括针对序列模型的数据预处理、针对文字输入的数据处理，以及针对图片输入的数据处理。所有函数都在Keras.preprocessing这个库里面，分别有text、sequence和image三个子库。</p></blockquote><blockquote><p>在文字的建模实践中，一般都需要把原始文字拆解成单字、单词或者词组，然后将这些拆分后的要素进行索引、标记化供机器学习算法使用。这种预处理叫作标注（Tokenize）。</p></blockquote><blockquote><p>对于已经读入的文字的预处理包含以下几个步骤。（1）文字拆分。（2）建立索引。（3）序列补齐（Padding）。（4）转换为矩阵。（5）使用标注类批量处理文本文件。所有跟文字相关的预处理函数都在Keras.preprocessing.text这个子库里。但是这是为英文文字设计的，如果是处理中文，因为中英文的差异，建议使用结巴分词里提供的切分函数cut来进行文字拆分。</p></blockquote><blockquote><p>根据结巴分词的介绍，其使用了如下算法来进行中文分词。基于前缀词典实现高效的词图扫描，生成句子中汉字所有可能成词情况所构成的有向无环图（DAG）。采用动态规划查找最大概率路径，找出基于词频的最大切分组合。对于未登录词，采用了基于汉字成词能力的HMM模型，使用Viterbi算法。</p></blockquote><blockquote><p>完成分词以后，得到的单字或者单词并不能直接用于建模，还需要将它们转换成数字序号，才能进行后续处理。这就是建立索引。建立索引的方法很简单，对于拆分出来的每一个单字或者单词，排序之后编号即可。</p></blockquote><blockquote><p>建立索引也可以使用OneHot编码法，即对于K个不同的单字或者单词，依次设定一个1到K之间的数值来索引这K个单字或者单词构成的词汇表。</p></blockquote><blockquote><p>一般要将大量不同的数据映射到一个有限空间中，通常采用的方法都是哈希表，one_hot函数也不例外。</p></blockquote><blockquote><p>最终索引之后的文字信息会被按照索引编号放入多维矩阵中用来建模。这个多维矩阵的行宽对应于所有拆分后的单字或者单词，但是在将索引放入矩阵中之前，需要先进行序列补齐的工作。这是因为将一段话拆分成单一的词以后，丢失了重要的上下文信息，因此将上下文的一组词放在一起建模能保持原来的上下文信息，从而提高建模的质量。</p></blockquote><blockquote><p>序列补齐分两种情况。</p></blockquote><blockquote><p>第一种情况是自然的文本序列，比如微博或者推特上的一段话，都是一个自然的单字或者单词序列，而待建模的数据是由很多微博或者推特组成的，或者对一组文章进行建模，每篇文章中的每一句话构成一个文本序列。这个时候每句话的长度不一，需要进行补齐为统一长度。第二种情况是将一个由K个（K较大）具备一定顺序的单词串拆分成小块的连续子串，每个子串只有M个（M&lt;K）单词。</p></blockquote><blockquote><p>所有的建模都只能使用多维矩阵，因此最后必须将索引过的文字元素转换成可以用于建模的矩阵。Keras提供了两种方法。第一种方法是使用pad_sequences函数。</p></blockquote><blockquote><p>第二种方法是使用下面将要介绍的标注类来进行。</p></blockquote><blockquote><p>当批量处理文本文件时，需要一种更高效的方法。Keras提供了一个标注类（Tokenizerclass）来进行文本处理。</p></blockquote><blockquote><p>另外一种对序列数据的处理方法叫作跳跃语法（SkipGram）模型。这是TomasMikolov在2013年提出的单词表述（WordRepresentation）模型，它把每个单词映射到一个M维的空间，它有一个更著名的别名，即Word2Vec。</p></blockquote><blockquote><p>在Keras的预处理模块中有一个skipgrams的函数，将一个词向量索引标号按照两种可选方式转化为一系列两两元素的组合（w1，w2）和标注z。如果w2跟w1是紧挨着的，则标注z为1，为正样本；如果w2是从不相邻的其他元素中随机抽取的，则标注z为负样本。</p></blockquote><blockquote><p>Keras为图片数据的输入提供了一个很好的接口，即Keras.preprocessing.image.ImageDataGenerator类。这个类生成一个数据生成器（Generator）对象，依照循环批量产生对应于图像信息的多维矩阵。</p></blockquote><blockquote><p>在Keras中设定了两类深度学习模型：一类是序列模型（Sequential类）；一类是通用模型（Model类）。</p></blockquote><blockquote><p>通用模型可以用来设计非常复杂、任意拓扑结构的神经网络，例如有向无环网络、共享层网络等。类似于序列模型，通用模型通过函数化的应用接口来定义模型。</p></blockquote><blockquote><p>对于序列模型和通用模型，它们的主要差异在于如何定义从输入层到输出层的各层结构。首先，在序列模型里，是先定义序列模型对象的；而在通用模型中是先定义从输入层到输出层各层要素的，包括尺寸结构。其次，在序列模型中，当有了一个模型对象以后，可以通过add方法对其依次添加各层信息，包括激活函数和网络尺寸来定义整个神经网络；而在通用模型中，是通过不停地封装含有各层网络结构的函数作为参数来定义网络结构的。最后，在序列模型中，各层只能依次线性添加；而在通用模型中，因为采用了封装的概念，可以在原有的网络结构上应用新的结构来快速生成新的模型，因此灵活度要高很多，特别是在具有多种类型的输入数据的情况下，比如在Keras手册中就举了一个教神经网络看视频进行自然语言问答的例子。在这个例子中，输入数据有两种：一是视频图像；二是自然语言的提问。首先通过构造多层卷积神经网络使用序列模型来对图像编码，然后将这个模型放入TimeDistributed函数中建立视频编码，最后使用LSTM对编码建模，同时对自然语言也进行从文字到向量的转换，在合并两个网络以后，将合并的网络作为参数输入下一个全连接层进行计算，并输出可能的回答。</p></blockquote><blockquote><p>Keras预先定义了很多对象用于帮助构造Keras的网络结构，比如常用的激活函数、参数初始化方法、正则化方法等。</p></blockquote><blockquote><p>选择。Keras提供了大量预定义好的激活函数，方便定制各种不同的网络结构。在Keras中使用激活对象有两种方法：一是单独定义一个激活层；二是在前置层里面通过激活选项来定义所需的激活函数。</p></blockquote><blockquote><p>初始化对象（Initializer）用于随机设定网络层激活函数中的权重值或者偏置项的初始值，包括kernel_initializer和bias_initializer。好的权重初始化值能帮助加快模型收敛速度。Keras预先定义了很多不同的初始化对象，包括：Zeros，将所有参数值都初始化为0。Ones，将所有参数值都初始化为1。Constant（value=1），将所有参数值都初始化为某一个常量，比如这里设置为1。RandomNormal，将所有参数值都按照一个正态分布所生成的随机数来初始化。正态分布的均值默认为0，而标准差默认为0.05。可以通过mean和stddev选项来修改。TruncatedNormal，使用一个截断正态分布生成的随机数来初始化参数向量，默认参数均值为0，标准差为0.05。对于均值的两个标准差之外的随机数会被遗弃并重新取样。这种初始化方法既有一定的多样性，又不会产生特别偏的值，因此是比较推荐的方法。针对不同的常用分布选项，Keras还提供了两个基于这种方法的特例，即glorot_normal和he_normal。前者的标准差不再是0.05，而是输入向量和输出向量的维度的函数：￼其中n1是输入向量的维度，而n2是输出向量的维度；后者的标准差只是输入向量的维度的函数：￼RandomUniform，按照均匀分布所生成的随机数来初始化参数值，默认的分布参数最小值为-0.05，最大值为0.05，可以通过minval和maxval选项分别修改。针对常用的分布选项，Keras还提供了两个基于这个分布的特例即glorot_uniform和he_uniform。前者均匀分布的上下限是输入向量和输出向量的维度的函数：￼而在后者上下限只是输入向量的维度的函数：￼自定义，用户可以自定义一个与参数维度相符合的初始化函数。下面的例子来自于Keras手册，使用后台的正态分布函数生成一组初始值，在定义网络层的时候调用这个函数即可。</p></blockquote><blockquote><p>在建模的时候，正则化是防止过度拟合的一个很常用的手段。在神经网络中也提供了正则化的手段，分别应用于权重参数、偏置项以及激活函数，对应的选项分别是kernel_regularizer、bias_reuglarizier和activity_regularizer。它们都可以应用Keras.regularizier.Regularizer对象，这个对象提供了定义好的一阶、二阶和混合的正则化方法，分别将前面的Regularizier替换为l1（x）、l2（x）和l1_l2（x1，x2），其中x或者x1，x2为非负实数，表明正则化的权重。</p></blockquote><blockquote><p>核心层（CoreLayer）是构成神经网络最常用的网络层的集合，包括：全连接层、激活层、放弃层、扁平化层、重构层、排列层、向量反复层、Lambda层、激活值正则化层、掩盖层。所有的层都包含一个输入端和一个输出端，中间包含激活函数以及其他相关参数等。（1）全连接层。在神经网络中最常见的网络层就是全连接层，在这个层中实现对神经网络里面的神经元的激活。</p></blockquote><blockquote><p>（2）激活层。激活层是对上一层的输出应用激活函数的网络层，这是除应用activation选项之外，另一种指定激活函数的方式。其用法很简单，只要在参数中指明所需的激活函数即可，预先定义好的函数直接引用其名字的字符串，或者使用TensorFlow和Theano自带的激活函数。</p></blockquote><blockquote><p>（3）放弃层。放弃层（Dropout）是对该层的输入向量应用放弃策略。在模型训练更新参数的步骤中，网络的某些隐含层节点按照一定比例随机设置为不更新状态，但是权重仍然保留，从而防止过度拟合。</p></blockquote><blockquote><p>（4）扁平化层。扁化层（Flatten）是将一个维度大于或等于3的高维矩阵按照设定“压扁”为一个二维的低维矩阵。</p></blockquote><blockquote><p>（5）重构层。重构层（Reshape）的功能和Numpy的Reshape方法一样，将一定维度的多维矩阵重新排列构造为一个新的保持同样元素数量但是不同维度尺寸的矩阵。</p></blockquote><blockquote><p>（6）排列层。排列层（Permute）按照给定的模式来排列输入向量的维度。这个方法在连接卷积网络和时间递归网络的时候非常有用。其参数是输入矩阵的维度编号在输出矩阵中的位置。</p></blockquote><blockquote><p>（7）向量反复层。顾名思义，向量反复层就是将输入矩阵重复多次。</p></blockquote><blockquote><p>（8）Lambda层。Lambda层可以将任意表达式包装成一个网络层对象。参数就是表达式，一般是一个函数，可以是一个自定义函数，也可以是任意已有的函数。</p></blockquote><blockquote><p>（9）激活值正则化层。这个网络层的作用是对输入的损失函数更新正则化。（10）掩盖层。该网络层主要使用在跟时间有关的模型中，比如LSTM。其作用是输入张量的时间步，在给定位置使用指定的数值进行“屏蔽”，用以定位需要跳过的时间步。</p></blockquote><blockquote><p>针对常见的卷积操作，Keras提供了相应的卷积层API，包括一维、二维和三维的卷积操作、切割操作、补零操作等。卷积在数学上被定义为作用于两个函数f和g上的操作来生成一个新的函数z。这个新的函数是原有两个函数的其中一个（比如f）在另一个（比如g）的值域上的积分或者加权平均。</p></blockquote><blockquote><p>卷积操作分为一维、二维和三维，对应的方法分别是Conv1D、Conv2D和Conv3D，这些方法有同样的选项，只是作用于不同维度的数据上，因此适用于不同的业务情景。</p></blockquote><blockquote><p>一维卷积通常被称为时域卷积，因为其主要应用在以时间排列的序列数据上，其使用卷积核对一维数据的邻近信号进行卷积操作来生成一个张量。二维卷积通常被称为空域卷积，一般应用在与图像相关的输入数据上，也是使用卷积核对输入数据进行卷积操作的。三维卷积也执行同样的操作。</p></blockquote><blockquote><p>Conv1D、Conv2D和Conv3D的选项几乎相同。filters：卷积滤子输出的维度，要求整数。kernel_size：卷积核的空域或时域窗长度。要求是整数或整数的列表，或者是元组。如果是单一整数，则应用于所有适用的维度。strides：卷积在宽或者高维度的步长。要求是整数或整数的列表，或者是元组。如果是单一整数，则应用于所有适用的维度。如果设定步长不为1，则dilation_rate选项的取值必须为1。padding：补齐策略，取值为valid、same或causal。causal将产生因果（膨胀的）卷积，即output[t]不依赖于input[t+1：]，在不能违反时间顺序的时序信号建模时有用。请参考WaveNet：AGenerativeModelforRawAudio，section2.1.。valid代表只进行有效的卷积，即对边界数据不处理。same代表保留边界处的卷积结果，通常会导致输出shape与输入shape相同。data_format：数据格式，取值为channels_last或者channels_first。这个选项决定了数据维度次序，其中channels_last对应的数据维度次序是（批量数，高，宽，频道数），而channels_first对应的数据维度次序为（批量数，频道数，高，宽）。activation：激活函数，为预定义或者自定义的激活函数名，请参考前面的“网络层对象”部分的介绍。如果不指定该选项，将不会使用任何激活函数（即使用线性激活函数：a（x）=x）。dilation_rate：该选项指定扩张卷积（DilatedConvolution）中的扩张比例。要求为整数或由单个整数构成的列表/元组，如果dilation_rate不为1，则步长一项必须设为1。use_bias：指定是否使用偏置项，取值为True或者False。kernel_initializer：权重初始化方法，为预定义初始化方法名的字符串，或用于初始化权重的函数。请参考前面的“网络层对象”部分的介绍。bias_initializer：偏置初始化方法，为预定义初始化方法名的字符串，或用于初始化偏置的函数。请参考前面的“网络层对象”部分的介绍。kernel_regularizer：施加在权重上的正则项，请参考前面的关于网络层对象中正则项的介绍。bias_regularizer：施加在偏置项上的正则项，请参考前面的关于网络层对象中正则项的介绍。activity_regularizer：施加在输出上的正则项，请参考前面的关于网络层对象中正则项的介绍。kernel_constraints：施加在权重上的约束项，请参考前面的关于网络层对象中约束项的介绍。bias_constraints：施加在偏置项上的约束项，请参考前面的关于网络层对象中约束项的介绍。</p></blockquote><blockquote><p>除上面介绍的卷积层以外，还有一些特殊的卷积层，比如SeparableConv2D、Conv2DTranspose、UpSampling1D、UpSampling2D、UpSampling3D、ZeroPadding1D、ZeroPadding2D、ZeroPadding3D等，</p></blockquote><blockquote><p>池化（Pooling）是在卷积神经网络中对图像特征的一种处理，通常在卷积操作之后进行。池化的目的是为了计算特征在局部的充分统计量，从而降低总体的特征数量，防止过度拟合和减少计算量。</p></blockquote><blockquote><p>Keras的池化层按照计算的统计量分为最大统计量池化和平均统计量池化；按照维度分为一维、二维和三维池化层；按照统计量计算区域分为局部池化和全局池化。</p></blockquote><blockquote><p>（1）最大统计量池化方法：</p></blockquote><blockquote><p>（2）平均统计量池化方法：这个方法的选项和数据格式要求跟最大化统计量池化方法一样，只是池化方法使用局部平均值而不是局部最大值作为充分统计量，</p></blockquote><blockquote><p>（3）全局池化方法：该方法应用全部特征维度的统计量来代表特征，因此会压缩数据维度。</p></blockquote><blockquote><p>在局部池化方法中，输出维度和输入维度是一样的，只是特征的维度尺寸因为池化变小；但是在全局池化方法中，输出维度小于输入维度，如在二维全局池化方法中输入维度为（样本数，频道数，行，列），全局池化以后行和列的维度都被压缩到全局统计量中，因此输出维度只有（样本数，频道数）二维。</p></blockquote><blockquote><p>循环层（RecurrentLayer）用来构造跟序列有关的神经网络。但是其本身是一个抽象类，无法实例化对象，在使用时应该使用LSTM，GRU和SimpleRNN三个子类来构造网络层。</p></blockquote><blockquote><p>简单循环层。SimpleRNN是循环层的一个子类，用来构造全连接的循环层，是循环网络最直接的应用，使用recurrent.SimipleRNN来调用。长短记忆层。LSTM是循环层的另一个子类，和简单循环层相比，其隐藏状态的权重网络稀疏。带记忆门的循环层（GRU）。</p></blockquote><blockquote><p>嵌入层（EmbeddingLayer）是使用在模型第一层的一个网络层，其目的是将所有索引标号映射到致密的低维向量中，</p></blockquote><blockquote><p>合并层是指将多个网络产生的张量通过一定方法合并在一起，</p></blockquote><blockquote><p>合并层支持不同的合并方法，包括：元素相加（merge.Add）、元素相乘（merge.Multiply）、元素取平均（merge.Average）、元素取最大（merge.Maximum）、叠加（merge.Concatenate）、矩阵相乘（merge.Dot）。</p></blockquote><blockquote><p>奇异值矩阵分解是一种基本的数学工具，被应用于大量的数据挖掘算法中，比较有名的有协同过滤（CollaborativeFiltering），PCA回归</p></blockquote><blockquote><p>矩阵分解的目的是解析矩阵的结构，提取重要信息，去除噪声，实现数据压缩等。比如在奇异值矩阵分解中，信息都集中在头几个特征向量中，使用这几个向量有可能较好地（即均方差尽可能小地）复原原来的矩阵，同时只需要保留较少的数据。</p></blockquote><blockquote><p>SVD基于以下线性代数定理：任何m×n的实数矩阵X可以表示为如下三个矩阵的乘积：m×r的酉矩阵U，被称为左特征向量矩阵；r×r的对角阵S，被称为特征值矩阵；r×n的酉矩阵VT，被称为右特征向量矩阵，其中r≤n。</p></blockquote><h2 id="5推荐系统"><a class="markdownIt-Anchor" href="#5推荐系统"></a> 5推荐系统</h2><blockquote><p>矩阵分解可以认为是一种信息压缩。这里有两种理解。第一种理解，用户和内容不是孤立的，用户喜好有相似性，内容也有相似性。压缩是把用户和内容数量化，压缩成k维的向量。</p></blockquote><blockquote><p>第二种理解，从深度学习的角度，用户表示输入层（UserRepresentation）通常用OneHot编码，这没问题，但是通过第一层全连接神经网络就可以到达隐藏层，就是所谓的嵌入层（EmbeddingLayer），也就是我们之前提到的向量压缩过程。</p></blockquote><blockquote><p>从机器学习的角度来说，模型是为了抓住数据的主要特征，去掉噪声。越复杂、越灵活的模型带来的噪声越多，降低维度则可以有效地避免过度拟合现象的出现。</p></blockquote><blockquote><p>一般批量大小为几百，迭代次数可以达到上百到几百范围。损失一般一开始会下降得比较快，随后慢慢下降。通常做法是等损失稳定下来后再结束训练会比较好。</p></blockquote><blockquote><p>训练数据拟合得好，只能说明算法本身是在做正确的优化事情，并不能说明模型在未知的数据集上是否是好的，也不能说明模型抓住了本质，排除了噪声。</p></blockquote><blockquote><p>交替最小二乘法的想法很简单，我们要解决的是分解矩阵M近似等于两个新矩阵A和B的乘积，限制条件是A、B的值不能太大，并且部分M的数据已知。类似于坐标下降法（CoordinateDescent）的想法，我们可以先固定A，这样求B就是一个最小二乘法的问题。类似的，得到了B以后固定B，再求A，循环迭代。如果最后A、B都收敛，即它们在两次迭代间的变换小于一个阈值时，就可以认为找到了问题的解。</p></blockquote><blockquote><p>宽深模型适用的场合是有多个特征，有些特征需要用交叉项特征合成（宽度模型），而有些特征需要进行高维抽象（深度模型）。宽深模型很好地结合了宽度模型和深度模型，同时具有记忆性和普适性，从而提高准确率。</p></blockquote><blockquote><p>协同过滤的含义是，利用众人的数据协助推断。一个经典的例子是，很多人买了牛奶的同时都买了面包，已知你买了牛奶，那么给你推荐面包就是很自然的事情。在实际数据上，这种方法效果一般，原因是类似于亚马逊等网站的商品太多了，用户之间很少能找到有很多重复的商品项，所以相似用户的构造会不准确。因而类似的规则便有很多噪声。</p></blockquote><blockquote><p>因子分解机是谷歌研究科学家S.Rendle教授提出的。它是矩阵分解的推广，可以使用多维特征变量。</p></blockquote><blockquote><p>玻尔兹曼向量机是谷歌副总裁、深度学习的开山鼻祖GeoffreyHinton提出的。该模型建立了电影及其表征之间的概率联系。从用户的行为可以推断出用户对于电影表征的偏好的概率表示；反过来，这些电影表征的偏好又可以用来给用户推荐电影。这种概率联系是通过RBM模型学出来的。</p></blockquote><blockquote><p>评判模型一般有两种指标：线上和线下。</p></blockquote><blockquote><p>线上需要设计实验，基于一定的随机规则对用户、设备或者浏览器Cookie进行分组，然后设定一些指标，观察这些指标在实验期运用新模型是否比旧模型好。</p></blockquote><blockquote><p>线上指标的优点是快速和因果关系明确；缺点是无法测试对长期目标的影响，并且容易不太稳定，受比如新奇效果（NoveltyEffect）或者实验渗透率的影响。</p></blockquote><blockquote><p>通常的做法是，在线下建模型的时候，用线下指标给出一个最好的模型。然后，把这个新模型和现有的在线模型拿到线上去，进行数据收集和统计分析，利用短期指标给出是否要推广新模型的结论。</p></blockquote><blockquote><p>在推荐系统中，评分类的数据一般用均方差（MeanSquaredError）作为评判标准；而对于隐含回馈数据，一般用基于信息检索的概念中的精确率（推荐10部电影，用户看了几部）和召回率（用户感兴趣的5部电影，是否都在推荐列表里）作为最常用的指标。</p></blockquote><h2 id="6图像识别"><a class="markdownIt-Anchor" href="#6图像识别"></a> 6图像识别</h2><blockquote><p>卷积神经网络（见图6.3）是一种自动化特征提取的机器学习模型。</p></blockquote><blockquote><p>神经网络就是建立了这样一个映射关系，或者称为函数。它通过建立网状结构，辅以矩阵的加、乘等运算，最后输出每个图像属于每个类别的概率，并且取概率最高的作为我们的决策依据。</p></blockquote><blockquote><p>用深度学习解决图像识别的问题，从直观上讲，是一个从细节到抽象的过程。</p></blockquote><blockquote><p>抽象就是把图像中的各种零散的特征通过某种方式汇总起来，形成新的特征，而利用这些新的特征更容易区分图像的类别。</p></blockquote><blockquote><p>深度神经网络最上层的特征是最抽象的。</p></blockquote><blockquote><p>后向传播算法的本质是高等代数里的链式法则。其原理就是机器不断通过现有参数在批量数据上所得到的标注和这些批量数据的真实标注的差距，给网络指示怎么调整网络模型和过滤器，即各种参数，从而在下一次批量数据上表现更好一些。下一次批量数据经过调整后的模型可能仍有很大的误差，网络会提示怎么进一步调整模型的权重和过滤器。这样不断反复，最终等过滤器和网络权重稳定下来，网络的训练就完成了。</p></blockquote><blockquote><p>卷积神经网络是深度学习的一种模型。它和一般的深度学习模型的主要区别是对模型有两个强假设。一般的深度学习模型只是假设模型有几层，每层有几个节点，然后把上下层之间的节点全部连接起来，这种模型的优点是灵活，缺点是灵活带来的副作用，即过度拟合。</p></blockquote><blockquote><p>过滤器一般需要的参数比较少，比如5×5×3的过滤器需要75个参数就可以了。这和多层神经网络相比，相当于我们只是把隐含层和局部输入联系在一起，而这两层之间的权重只需要75个参数。其他超过这个局部范围的区域的网络权重都是0。</p></blockquote><blockquote><p>第二个是局部像素的相关性，即局部区域的像素值一般差的不太多。基于此衍生了一种处理技术——MaxPooling，即在局部，比如在224×224的格子里，取局部区域像素值的最大值。</p></blockquote><blockquote><p>从另一个角度看，任何一个卷积神经网络其实都是通过对整个神经网络权重附加参数共享这一限制而实现的。所以卷积神经网络和全连接神经网络是可以相互转换的。</p></blockquote><blockquote><p>一般一个卷积层包括3个部分：卷积步骤、非线性变化（一般是relu、tanh、sigmoid等）和MaxPooling。有的网络还包括了Dropout这一步。总结来说，一些流行的卷积神经网络，比如LeNet、VGG16等，都是通过构造多层的卷积层，使得原来“矮胖”型的图像输入层（224×224×3）立体，变成比如1×1×4096之类的“瘦长”型立体，最后做一个单层的网络，把“瘦长”型立体和输出层（类别）联系在一起。</p></blockquote><blockquote><p>在局部扫描的过程中，有一个参数叫步长，就是指过滤器以多大的跨度上下或左右平移地扫描。</p></blockquote><blockquote><p>对于经由过滤器局部扫描后的卷积层图像，由于处理边界不同，一般有两种处理方式。一种是在局部扫描过程中对图像边界以外的一层或多层填上0，平移的时候可以将其移出边界到达0的区域。这样的好处是在以1为步长的局部扫描完以后，所得的新图像和原图像长宽一致，被称作zeropadding（samepadding）。另一种是不对边界外做任何0的假定，所有平移都在边界内，被称作validpadding，使用这种方式通常扫描完的图像尺寸会比原来的小。</p></blockquote><h2 id="7自然语言情感分析"><a class="markdownIt-Anchor" href="#7自然语言情感分析"></a> 7自然语言情感分析</h2><blockquote><p>进行情感分析有如下难点：第一，文字非结构化，有长有短，很难适合经典的机器学习分类模型。第二，特征不容易提取。文字可能是谈论这个主题的，也可能是谈论人物、商品或事件的。人工提取特征耗费的精力太大，效果也不好。第三，词与词之间有联系，把这部分信息纳入模型中也不容易。</p></blockquote><blockquote><p>深度学习适合做文字处理和语义理解，是因为深度学习结构灵活，其底层利用词嵌入技术可以避免文字长短不均带来的处理困难。使用深度学习抽象特征，可以避免大量人工提取特征的工作。深度学习可以模拟词与词之间的联系，有局部特征抽象化和记忆功能。</p></blockquote><blockquote><p>第一，文字分词。英语分词可以按照空格分词，中文分词可以参考jieba。第二，建立字典，给每个词标号。第三，把段落按字典翻译成数字，变成一个array。</p></blockquote><blockquote><p>为了克服文字长短不均和将词与词之间的联系纳入模型中的困难，人们使用了一种技术——词嵌入。简单说来，就是给每个词赋一个向量，向量代表空间里的点，含义接近的词，其向量也接近，这样对于词的操作就可以转化为对于向量的操作了，在深度学习中，这被叫作张量（tensor）。</p></blockquote><blockquote><p>从优化的角度讲，深度学习网络还有其他一些梯度下降优化方法，比如Adagrad等。它们的本质都是解决在调整神经网络模型过程中如何控制学习速度的问题。</p></blockquote><h2 id="8文字生成"><a class="markdownIt-Anchor" href="#8文字生成"></a> 8文字生成</h2><blockquote><p>基于深度学习的检索式对话系统在后两点上有较大的改进。通过机器学习，可以实现软匹配，不需要询问语句模式一定要在库里出现，如果通过对词汇和其组织顺序的建模发现有较高概率匹配的数据点，就能实现比较好的回应。其次，深度学习方法提供了更高的灵活性，能够实现记忆和识别等功能。</p></blockquote></div><div><div><div style="text-align:center;color:#ccc;font-size:14px">-------------本文结束<i class="fa fa-paw"></i>感谢您的阅读-------------</div></div></div><div class="reward-container"><div>坚持原创技术分享，您的支持将鼓励我继续创作！.</div><button onclick='var qr=document.getElementById("qr");qr.style.display="none"===qr.style.display?"block":"none"'>打赏</button><div id="qr" style="display:none"><div style="display:inline-block"><img src="/images/loading.gif" data-original="/images/wechatpay.png" alt="绍桂 微信支付"><p>微信支付</p></div><div style="display:inline-block"><img src="/images/loading.gif" data-original="/images/alipay.png" alt="绍桂 支付宝"><p>支付宝</p></div></div></div><div><ul class="post-copyright"><li class="post-copyright-author"><strong>本文作者： </strong>绍桂</li><li class="post-copyright-link"><strong>本文链接：</strong> <a href="https://shaogui.life/2020/06/02/%E4%B9%A6%E6%91%98_Keras%E5%BF%AB%E9%80%9F%E4%B8%8A%E6%89%8B%EF%BC%9A%E5%9F%BA%E4%BA%8EPython%E7%9A%84%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E5%AE%9E%E6%88%98-%E8%B0%A2%E6%A2%81;%E9%B2%81%E9%A2%96;%E5%8A%B3%E8%99%B9%E5%B2%9A.hexo/" title="书摘：《Keras快速上手：基于Python的深度学习实战》-谢梁;鲁颖;劳虹岚">https://shaogui.life/2020/06/02/书摘_Keras快速上手：基于Python的深度学习实战-谢梁;鲁颖;劳虹岚.hexo/</a></li><li class="post-copyright-license"><strong>版权声明： </strong>本博客所有文章除特别声明外，均采用 <a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" rel="noopener" target="_blank"><i class="fab fa-fw fa-creative-commons"></i>BY-NC-SA</a> 许可协议。转载请注明出处！</li></ul></div><div class="followme"><p>欢迎关注我的其它发布渠道</p><div class="social-list"><div class="social-item"><a target="_blank" class="social-link" href="/images/wechat_channel.jpg"><span class="icon"><i class="fab fa-weixin"></i> </span><span class="label">WeChat</span></a></div><div class="social-item"><a target="_blank" class="social-link" href="/atom.xml"><span class="icon"><i class="fa fa-rss"></i> </span><span class="label">RSS</span></a></div></div></div><footer class="post-footer"><div class="post-tags"><a href="/tags/%E8%AF%BB%E4%B9%A6/" rel="tag"><i class="fa fa-tag"></i> 读书</a></div><div class="post-nav"><div class="post-nav-item"><a href="/2020/05/26/CCNet%EF%BC%9ACriss-Cross%20Attention%20for%20Semantic%20Segmentation/" rel="prev" title="CCNet：Criss-Cross Attention for Semantic Segmentation"><i class="fa fa-chevron-left"></i> CCNet：Criss-Cross Attention for Semantic Segmentation</a></div><div class="post-nav-item"><a href="/2020/06/02/You%20Only%20Look%20Once%EF%BC%9AUnified%20Real-Time%20Object%20Detection/" rel="next" title="You Only Look Once：Unified Real-Time Object Detection">You Only Look Once：Unified Real-Time Object Detection <i class="fa fa-chevron-right"></i></a></div></div></footer></article></div><div class="comments" id="valine-comments"></div><script>window.addEventListener('tabs:register', () => {
    let { activeClass } = CONFIG.comments;
    if (CONFIG.comments.storage) {
      activeClass = localStorage.getItem('comments_active') || activeClass;
    }
    if (activeClass) {
      let activeTab = document.querySelector(`a[href="#comment-${activeClass}"]`);
      if (activeTab) {
        activeTab.click();
      }
    }
  });
  if (CONFIG.comments.storage) {
    window.addEventListener('tabs:click', event => {
      if (!event.target.matches('.tabs-comment .tab-content .tab-pane')) return;
      let commentClass = event.target.classList[1];
      localStorage.setItem('comments_active', commentClass);
    });
  }</script></div><div class="toggle sidebar-toggle"><span class="toggle-line toggle-line-first"></span> <span class="toggle-line toggle-line-middle"></span> <span class="toggle-line toggle-line-last"></span></div><aside class="sidebar"><div class="sidebar-inner"><ul class="sidebar-nav motion-element"><li class="sidebar-nav-toc">文章目录</li><li class="sidebar-nav-overview">站点概览</li></ul><div class="post-toc-wrap sidebar-panel"><div class="post-toc motion-element"><ol class="nav"><li class="nav-item nav-level-2"><a class="nav-link" href="#1%E5%87%86%E5%A4%87%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%9A%84%E7%8E%AF%E5%A2%83"><span class="nav-number">1.</span> <span class="nav-text">1准备深度学习的环境</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#2%E6%95%B0%E6%8D%AE%E6%94%B6%E9%9B%86%E4%B8%8E%E5%A4%84%E7%90%86"><span class="nav-number">2.</span> <span class="nav-text">2数据收集与处理</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#3%E6%B7%B1%E5%BA%A6%E5%AD%A6%E4%B9%A0%E7%AE%80%E4%BB%8B"><span class="nav-number">3.</span> <span class="nav-text">3深度学习简介</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#4keras%E5%85%A5%E9%97%A8"><span class="nav-number">4.</span> <span class="nav-text">4Keras入门</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#5%E6%8E%A8%E8%8D%90%E7%B3%BB%E7%BB%9F"><span class="nav-number">5.</span> <span class="nav-text">5推荐系统</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#6%E5%9B%BE%E5%83%8F%E8%AF%86%E5%88%AB"><span class="nav-number">6.</span> <span class="nav-text">6图像识别</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#7%E8%87%AA%E7%84%B6%E8%AF%AD%E8%A8%80%E6%83%85%E6%84%9F%E5%88%86%E6%9E%90"><span class="nav-number">7.</span> <span class="nav-text">7自然语言情感分析</span></a></li><li class="nav-item nav-level-2"><a class="nav-link" href="#8%E6%96%87%E5%AD%97%E7%94%9F%E6%88%90"><span class="nav-number">8.</span> <span class="nav-text">8文字生成</span></a></li></ol></div></div><div class="site-overview-wrap sidebar-panel"><div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person"><img class="site-author-image" itemprop="image" alt="绍桂" src="/images/loading.gif" data-original="/images/avatar.gif"><p class="site-author-name" itemprop="name">绍桂</p><div class="site-description" itemprop="description">害怕失败是本能，勇敢面对才是本事</div></div><div class="site-state-wrap motion-element"><nav class="site-state"><div class="site-state-item site-state-posts"><a href="/archives/"><span class="site-state-item-count">214</span> <span class="site-state-item-name">日志</span></a></div><div class="site-state-item site-state-categories"><a href="/categories/"><span class="site-state-item-count">7</span> <span class="site-state-item-name">分类</span></a></div><div class="site-state-item site-state-tags"><a href="/tags/"><span class="site-state-item-count">79</span> <span class="site-state-item-name">标签</span></a></div></nav></div><div class="links-of-author motion-element"><span class="links-of-author-item"><a href="https://github.com/WuShaogui" title="GitHub → https:&#x2F;&#x2F;github.com&#x2F;WuShaogui" rel="noopener" target="_blank"><i class="fab fa-github fa-fw"></i>GitHub</a> </span><span class="links-of-author-item"><a href="/wshglearn@163.com" title="E-Mail → wshglearn@163.com"><i class="fa fa-envelope fa-fw"></i>E-Mail</a></span></div><div class="cc-license motion-element" itemprop="license"><a href="https://creativecommons.org/licenses/by-nc-sa/4.0/" class="cc-opacity" rel="noopener" target="_blank"><img src="/images/loading.gif" data-original="/images/cc-by-nc-sa.svg" alt="Creative Commons"></a></div><div class="links-of-blogroll motion-element"><div class="links-of-blogroll-title"><i class="fa fa-link fa-fw"></i> Links</div><ul class="links-of-blogroll-list"><li class="links-of-blogroll-item"><a href="http://manaai.cn/" title="http:&#x2F;&#x2F;manaai.cn&#x2F;" rel="noopener" target="_blank">神力AI</a></li></ul></div></div><div class="back-to-top motion-element"><i class="fa fa-arrow-up"></i> <span>0%</span></div></div></aside><div id="sidebar-dimmer"></div></div></main><footer class="footer"><div class="footer-inner"><div class="copyright">&copy; <span itemprop="copyrightYear">2023</span> <span class="with-love"><i class="fa fa-heart"></i> </span><span class="author" itemprop="copyrightHolder">绍桂</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-chart-area"></i> </span><span class="post-meta-item-text">站点总字数：</span> <span title="站点总字数">524k</span> <span class="post-meta-divider">|</span> <span class="post-meta-item-icon"><i class="fa fa-coffee"></i> </span><span class="post-meta-item-text">站点阅读时长 &asymp;</span> <span title="站点阅读时长">7:56</span></div><div class="powered-by">由 <a href="https://hexo.io/" class="theme-link" rel="noopener" target="_blank">Hexo</a> & <a href="https://theme-next.org/" class="theme-link" rel="noopener" target="_blank">NexT.Gemini</a> 强力驱动</div><div><span id="timeDate">载入天数...</span><span id="times">载入时分秒...</span><script>var now=new Date;function createtime(){var n=new Date("03/04/2020 00:00:00");now.setTime(now.getTime()+250),days=(now-n)/1e3/60/60/24,dnum=Math.floor(days),hours=(now-n)/1e3/60/60-24*dnum,hnum=Math.floor(hours),1==String(hnum).length&&(hnum="0"+hnum),minutes=(now-n)/1e3/60-1440*dnum-60*hnum,mnum=Math.floor(minutes),1==String(mnum).length&&(mnum="0"+mnum),seconds=(now-n)/1e3-86400*dnum-3600*hnum-60*mnum,snum=Math.round(seconds),1==String(snum).length&&(snum="0"+snum),document.getElementById("timeDate").innerHTML="本站已安全运行 "+dnum+" 天 ",document.getElementById("times").innerHTML=hnum+" 小时 "+mnum+" 分 "+snum+" 秒"}setInterval("createtime()",250)</script></div><div class="busuanzi-count"><script async src="https://busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span class="post-meta-item" id="busuanzi_container_site_uv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-user"></i> </span><span class="site-uv" title="总访客量"><span id="busuanzi_value_site_uv"></span> </span></span><span class="post-meta-divider">|</span> <span class="post-meta-item" id="busuanzi_container_site_pv" style="display:none"><span class="post-meta-item-icon"><i class="fa fa-eye"></i> </span><span class="site-pv" title="总访问量"><span id="busuanzi_value_site_pv"></span></span></span></div></div></footer></div><script src="/lib/anime.min.js"></script><script src="/lib/velocity/velocity.min.js"></script><script src="/lib/velocity/velocity.ui.min.js"></script><script src="/js/utils.js"></script><script src="/js/motion.js"></script><script src="/js/schemes/pisces.js"></script><script src="/js/next-boot.js"></script><script src="/js/local-search.js"></script><script>NexT.utils.loadComments(document.querySelector('#valine-comments'), () => {
  NexT.utils.getScript('//unpkg.com/valine/dist/Valine.min.js', () => {
    var GUEST = ['nick', 'mail', 'link'];
    var guest = 'nick,mail,link';
    guest = guest.split(',').filter(item => {
      return GUEST.includes(item);
    });
    new Valine({
      el         : '#valine-comments',
      verify     : false,
      notify     : false,
      appId      : 'DaC9WfpDSEo1UXF6EGhA689F-gzGzoHsz',
      appKey     : 'PJc4GhBjIfpJ3kU0NVWtYxIH',
      placeholder: "留下你的评论吧",
      avatar     : 'mm',
      meta       : guest,
      pageSize   : '10' || 10,
      visitor    : true,
      lang       : '' || 'zh-cn',
      path       : location.pathname,
      recordIP   : true,
      serverURLs : ''
    });
  }, window.Valine);
});</script><script>
            window.imageLazyLoadSetting = {
                isSPA: false,
                processImages: null,
            };
        </script><script>window.addEventListener("load",function(){var t=/\.(gif|jpg|jpeg|tiff|png)$/i,r=/^data:image\/[a-z]+;base64,/;Array.prototype.slice.call(document.querySelectorAll("img[data-original]")).forEach(function(a){var e=a.parentNode;"A"===e.tagName&&(e.href.match(t)||e.href.match(r))&&(e.href=a.dataset.original)})});</script><script>!function(n){n.imageLazyLoadSetting.processImages=o;var i=n.imageLazyLoadSetting.isSPA,r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]"));function o(){i&&(r=Array.prototype.slice.call(document.querySelectorAll("img[data-original]")));for(var t,e,a=0;a<r.length;a++)t=r[a],e=void 0,0<=(e=t.getBoundingClientRect()).bottom&&0<=e.left&&e.top<=(n.innerHeight||document.documentElement.clientHeight)&&function(){var t,e,n,i,o=r[a];t=o,e=function(){r=r.filter(function(t){return o!==t})},n=new Image,i=t.getAttribute("data-original"),n.onload=function(){t.src=i,e&&e()},n.src=i}()}o(),n.addEventListener("scroll",function(){var t,e;t=o,e=n,clearTimeout(t.tId),t.tId=setTimeout(function(){t.call(e)},500)})}(this);</script></body></html>